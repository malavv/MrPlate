cmake_minimum_required(VERSION 3.10)
project(MrEmulator)
set(CMAKE_CXX_STANDARD 11)

set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_SOURCE_DIR}/cmake")

# SDL2 Libraries
set(SDL2_DIR "${CMAKE_SOURCE_DIR}/lib/SDL2-2.0.8")
find_package(SDL2 REQUIRED)
find_package(SDL2_image REQUIRED)
find_package(SDL2_ttf REQUIRED)
include_directories(${SDL2_INCLUDE_DIRS} ${SDL2_IMAGE_INCLUDE_DIRS} ${SDL2TTF_INCLUDE_DIR})

# Adafruit Libraries
include_directories(
  "${CMAKE_SOURCE_DIR}/lib/Adafruit_SSD1306"
  "${CMAKE_SOURCE_DIR}/lib/Adafruit-GFX-Library")
set(ADAFRUIT_SOURCE
  "${CMAKE_SOURCE_DIR}/lib/Adafruit_SSD1306/Adafruit_SSD1306.cpp"
  "${CMAKE_SOURCE_DIR}/lib/Adafruit_SSD1306/Adafruit_SSD1306.h"
  "${CMAKE_SOURCE_DIR}/lib/Adafruit-GFX-Library/Adafruit_GFX.cpp"
  "${CMAKE_SOURCE_DIR}/lib/Adafruit-GFX-Library/Adafruit_GFX.h")

# Android Emulation
include_directories("${PROJECT_SOURCE_DIR}/src/emulator")

# Source
include_directories(${PROJECT_SOURCE_DIR}/src)

set(SOURCE_FILES 
  #src/example.cpp 
  src/main.cpp 
  src/emulator/Arduino.cpp 
  src/emulator/emulator.cpp
  src/emulator/ui.h
  src/emulator/ui.cpp
  src/emulator/LTexture.h
  src/emulator/LTexture.cpp)

add_executable(${PROJECT_NAME} ${SOURCE_FILES} ${ADAFRUIT_SOURCE})
target_link_libraries(${PROJECT_NAME} ${SDL2_LIBRARIES} ${SDL2_IMAGE_LIBRARIES} ${SDL2TTF_LIBRARY})

# Copy DLLs
add_custom_command(TARGET ${PROJECT_NAME} POST_BUILD
  COMMAND ${CMAKE_COMMAND} -E copy_directory
    "${SDL2_DIR}/${VC_LIB_PATH_SUFFIX}"
    $<TARGET_FILE_DIR:${PROJECT_NAME}>)